<div class="char-wrap">
  <div class="new_project_cont"><span>New Project >&nbsp; </span>
    <p> {{projectname}}</p>
  </div>
  <div class="chat-container" #scrollMe [scrollTop]="scrollMe.scrollHeight">

    <div *ngFor="let msg of messages(); let i = index; trackBy: trackByMsg;"
      [ngClass]="{ 'bot': msg.from === 'bot', 'user': msg.from === 'user' }" class="message">
      <div class="bubble">
        <ng-container *ngIf="msg.text.startsWith('typing'); else normalText">
          <div class="typing-indicator">
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
          </div>
        </ng-container>
        <ng-template #normalText>{{ msg.text }}</ng-template>
       
<ng-container *ngIf="msg.upload_file === 0">
<div [ngClass]="{ 'Options_list': msg.upload_file === 0 }">
          <div *ngFor="let option of msg.options; let j = index" class="option"
            (click)="handleOptionSelect(option)"
            >
            {{ option }}
          </div>
          </div>
</ng-container>
<ng-container *ngIf="msg.upload_file === 1">
<div class="file-upload">
  <div style="display: flex;">
    <div>
       <h4>Listed File</h4>
          <div *ngFor="let item of msg.options; let j = index" class="option"
            (click)="file_upload()"
            >
            {{ item.display_text }}
          </div>
        </div>
        <div class="file-list" *ngIf="files.length > 0">
  <h4>Uploaded File</h4>

  <div cdkDropList (cdkDropListDropped)="drop($event)" class="file-ul">
  <div *ngFor="let file of files; let i = index" cdkDrag class="file-item" style="display: flex;"
       [ngClass]="{'failed': fileStatus[file.name]?.status === 'failed'}">
    <div class="file-info">
      <span>{{ file.name }}</span>
      <div class="status-indicator">
        <!-- <span *ngIf="fileStatus[file.name]?.status === 'pending'">⏳ Pending</span> -->
        <span *ngIf="fileStatus[file.name]?.status === 'uploading'">📤 Uploading...</span>
        <span *ngIf="fileStatus[file.name]?.status === 'success'" class="success">✅ Uploaded</span>
        <span *ngIf="fileStatus[file.name]?.status === 'failed'" class="error">❌ Failed</span>
      </div>
      <div *ngIf="fileStatus[file.name]?.reason" class="error-message">
        {{ fileStatus[file.name].reason }}
      </div>
    </div>
    <div class="file-actions">
      <button class="btn-delete" (click)="deleteFile(i)">🗑 Delete</button>
      <button class="btn-replace" (click)="openReplace(i)">🔁 Replace</button>
      <button class="btn-reupload" 
              *ngIf="fileStatus[file.name]?.status === 'failed'"
              (click)="reuploadFile(i)">
        🔄 Re-upload
      </button>
    </div>
  </div>
</div>
</div>
          </div>
          <div
            class="drop-zone"
            (drop)="!allFilesUploaded && onFileDropped($event)"
            (dragover)="!allFilesUploaded && onDragOver($event)"
            [class.disabled]="allFilesUploaded"
          >
            <p>📂 Drag & Drop Excel files here</p>
            <p>or</p>
            <button (click)="fileInput.click()" [disabled]="allFilesUploaded">Browse Files</button>
            <input
              #fileInput
              type="file"
              multiple
              accept=".xls,.xlsx"
              (change)="onFileBrowse($event)"
              [disabled]="allFilesUploaded"
              hidden
            />
  <!-- Hidden input used to replace a specific file -->
  <input id="replaceInput" type="file" accept=".xls,.xlsx" (change)="onReplaceSelected($event)" hidden />
</div>



<button (click)="uploadAll()" [disabled]="allFilesUploaded">
  🚀 Upload All
</button>

          </div>
</ng-container>


        
      </div>
    </div>
  </div>
  <!-- <div class="search" fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="0px">
    <div class="glob" fxLayout="column">
      <img src="../../../assets/images/Frame 54.png" />
    </div>

    <div fxFlex appearance="fill">
      <div class="custom-input">
        <mat-form-field appearance="fill">
          <mat-label>Search</mat-label>
          <input matInput placeholder="Search..." [(ngModel)]="searchText" (keydown.enter)="sendUserMessage()" />
        </mat-form-field>
      </div>
    </div>

    <div fxLayout="column" class="send_btn" (click)="sendUserMessage()">
      <img src="../../../assets/images/Group.png" />
    </div>
  </div> -->
</div>